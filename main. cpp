#include <iostream>
#include <vector>
#include "Student.h"
#include "AttendanceSession.h"

using namespace std;

int main() {

    vector<Student> students = Student::loadFromFile();
    vector<AttendanceSession> sessions;

    int choice;

    do {
        cout << "\n===== DIGITAL ATTENDANCE SYSTEM =====\n";
        cout << "1. Register Student\n";
        cout << "2. View Students\n";
        cout << "3. Create Lecture Session\n";
        cout << "4. View Lecture Sessions\n";
        cout << "5. Exit\n";
        cout << "Enter choice: ";
        cin >> choice;

        if (choice == 1) {
            Student s;
            s.inputStudent();

            bool exists = false;
            for (const Student& st : students) {
                if (st.getIndex() == s.getIndex()) {
                    exists = true;
                    break;
                }
            }

            if (exists) {
                cout << "Student with this index already exists!\n";
            } else {
                students.push_back(s);
                s.saveToFile();
                cout << "Student registered successfully!\n";
            }
        }

        else if (choice == 2) {
            for (const Student& s : students) {
                s.displayStudent();
            }
        }

        else if (choice == 3) {
            AttendanceSession session;
            session.createSession();
            sessions.push_back(session);
            cout << "Lecture session created successfully!\n";
        }

        else if (choice == 4) {
            for (const AttendanceSession& s : sessions) {
                s.displaySession();
            }
        }

        else if (choice == 5) {
            cout << "Exiting system...\n";
        }

        else {
            cout << "Invalid choice!\n";
        }

    } while (choice != 5);

    return 0;
}
